<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øª Ù†Ø§Ù…</title>

<style>
body{
    margin:0;
    font-family:tahoma;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:radial-gradient(circle at top right,#3b0f70,#0b1c2d 60%);
}

.container{
    width:420px;
    padding:40px 35px;
    border-radius:25px;
    background:rgba(255,255,255,0.06);
    backdrop-filter:blur(20px);
    border:1px solid rgba(255,255,255,0.08);
    box-shadow:0 0 60px rgba(128,0,255,.25),0 20px 40px rgba(0,0,0,.6);
    color:#fff;
}

h2{text-align:center;margin-bottom:30px;font-weight:600;}

input,select,textarea{
    width:100%;
    padding:14px;
    margin-top:15px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,0.15);
    background:rgba(255,255,255,0.08);
    color:#fff;
    font-size:14px;
    outline:none;
    transition:.3s;
    box-sizing:border-box;
}

select option{
    background:#1e1e2f;
    color:#ffffff;
}

input:focus,select:focus,textarea:focus{
    border:1px solid #9d4edd;
    box-shadow:0 0 15px rgba(157,78,221,.4);
}

button{
    width:100%;
    padding:14px;
    margin-top:25px;
    border:none;
    border-radius:14px;
    background:linear-gradient(90deg,#9d4edd,#7b2cbf);
    color:#fff;
    cursor:pointer;
}

button:disabled{opacity:.5;cursor:not-allowed;}

.link-row{text-align:center;margin-top:20px;font-size:13px;}
.link-action{color:#c77dff;cursor:pointer;margin-right:6px;font-weight:bold;}
.success{text-align:center;color:#80ffdb;margin-top:10px;}
.hidden{display:none;}
</style>
</head>

<body>

<div class="container">

<div id="loginBox">
<h2>ÙˆØ±ÙˆØ¯</h2>
<input type="text" id="loginNational" placeholder="Ú©Ø¯ Ù…Ù„ÛŒ" maxlength="10">
<button id="loginBtn" disabled>Ø§Ø¯Ø§Ù…Ù‡</button>
<div class="success" id="loginMsg"></div>

<div class="link-row">
Ø«Ø¨Øª Ù†Ø§Ù… Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØŸ
<span class="link-action" onclick="showRegister()">Ø«Ø¨Øª Ù†Ø§Ù…</span>
</div>
</div>

<div id="registerBox" class="hidden">
<h2>Ø«Ø¨Øª Ù†Ø§Ù…</h2>

<div id="stepRole">
<select id="roleSelect">
<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù‚Ø´</option>
<option value="student">Ø¯Ø§Ù†Ø´ Ø¢Ù…ÙˆØ²</option>
<option value="teacher">Ø§Ø³ØªØ§Ø¯</option>
<option value="school">Ù…Ø¯Ø±Ø³Ù‡</option>
</select>
<button id="roleNext" disabled>ØªØ§ÛŒÛŒØ¯</button>
</div>

<div id="studentForm" class="hidden">

<div id="studentStep1">
<input type="text" id="s_fullName" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
<input type="text" id="s_phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
<input type="text" id="s_nationalCode" placeholder="Ú©Ø¯ Ù…Ù„ÛŒ" maxlength="10">
<input type="date" id="s_birthDate">
<select id="s_school">
<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¯Ø±Ø³Ù‡</option>
<option>Ù‡Ù†Ø±Ø³ØªØ§Ù† ÙØ¶Ø§</option>
<option>Ù‡Ù†Ø±Ø³ØªØ§Ù† Ø³Ù…Ø§</option>
</select>
<button onclick="nextStep('studentStep1','studentStep2')">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯</button>
</div>

<div id="studentStep2" class="hidden">
<select id="levelSelect" onchange="updateGrades()">
<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù‚Ø·Ø¹</option>
<option value="primary">Ø§Ø¨ØªØ¯Ø§ÛŒÛŒ</option>
<option value="middle">Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ</option>
<option value="high">Ø¯Ø¨ÛŒØ±Ø³ØªØ§Ù†</option>
</select>

<select id="gradeSelect" class="hidden"></select>

<select id="majorSelect" class="hidden">
<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø±Ø´ØªÙ‡</option>
<option>Ø±ÛŒØ§Ø¶ÛŒ</option>
<option>Ø¹Ù„ÙˆÙ… ØªØ¬Ø±Ø¨ÛŒ</option>
<option>Ø§Ù†Ø³Ø§Ù†ÛŒ</option>
<option>ÙÙ†ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</option>
<option>Ú©Ø§Ø±Ø¯Ø§Ù†Ø´</option>
</select>

<button type="button" onclick="submitStudent()">Ø«Ø¨Øª Ù†Ù‡Ø§ÛŒÛŒ</button>
</div>

</div>
</div>
</div>

<script>
/* ğŸ”¥ Ù„ÛŒÙ†Ú© Web App Google Sheets */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyv3FwqIkG_V8qRi3OOm4IpGnzWtA0Ii0kQ0BGWrT7tYrzBwLudRb3sb6zAFMUXup2_/exec";

/* ÙˆØ±ÙˆØ¯ */
const loginNational = document.getElementById("loginNational");
const loginBtn = document.getElementById("loginBtn");

loginNational.addEventListener("input", function(){
    loginBtn.disabled = this.value.length !== 10;
});

/* Ù†Ù…Ø§ÛŒØ´ ÙØ±Ù… Ø«Ø¨Øª Ù†Ø§Ù… */
function showRegister(){
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("registerBox").classList.remove("hidden");
}

/* Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù‚Ø´ */
const roleSelect = document.getElementById("roleSelect");
const roleNext = document.getElementById("roleNext");

roleSelect.addEventListener("change",function(){
    roleNext.disabled = this.value==="";
});

roleNext.onclick = function(){
    document.getElementById("stepRole").classList.add("hidden");
    if(roleSelect.value==="student") document.getElementById("studentForm").classList.remove("hidden");
}

/* Ù…Ø±Ø§Ø­Ù„ ÙØ±Ù… Ø¯Ø§Ù†Ø´ Ø¢Ù…ÙˆØ² */
function nextStep(current,next){
    document.getElementById(current).classList.add("hidden");
    document.getElementById(next).classList.remove("hidden");
}

/* Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ù„Ø§Ø³â€ŒÙ‡Ø§ Ùˆ Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ */
function updateGrades(){
    const levelSelect = document.getElementById("levelSelect");
    const gradeSelect = document.getElementById("gradeSelect");
    const majorSelect = document.getElementById("majorSelect");

    gradeSelect.innerHTML = "";
    gradeSelect.classList.remove("hidden");
    majorSelect.classList.add("hidden");

    if(levelSelect.value==="primary"){
        gradeSelect.innerHTML='<option>Ø§ÙˆÙ„</option><option>Ø¯ÙˆÙ…</option><option>Ø³ÙˆÙ…</option><option>Ú†Ù‡Ø§Ø±Ù…</option><option>Ù¾Ù†Ø¬Ù…</option><option>Ø´Ø´Ù…</option>';
    }
    else if(levelSelect.value==="middle"){
        gradeSelect.innerHTML='<option>Ù‡ÙØªÙ…</option><option>Ù‡Ø´ØªÙ…</option><option>Ù†Ù‡Ù…</option>';
    }
    else if(levelSelect.value==="high"){
        gradeSelect.innerHTML='<option>Ø¯Ù‡Ù…</option><option>ÛŒØ§Ø²Ø¯Ù‡Ù…</option><option>Ø¯ÙˆØ§Ø²Ø¯Ù‡Ù…</option>';
        majorSelect.classList.remove("hidden");
    }
}

/* Ø§Ø±Ø³Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø§Ù†Ø´ Ø¢Ù…ÙˆØ² */
function submitStudent(){
    const data = {
        fullName: document.getElementById("s_fullName").value,
        phone: document.getElementById("s_phone").value,
        nationalCode: document.getElementById("s_nationalCode").value,
        birthDate: document.getElementById("s_birthDate").value,
        schoolName: document.getElementById("s_school").value,
        level: document.getElementById("levelSelect").value,
        grade: document.getElementById("gradeSelect").value,
        major: document.getElementById("majorSelect").value
    };

    fetch(SCRIPT_URL,{
        method:"POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    })
    .then(res=>res.json())
    .then(res=>{
        alert("Ø«Ø¨Øª Ù†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ âœ…");
        // Ø±ÛŒØ³Øª ÙØ±Ù…
        document.getElementById("studentForm").querySelectorAll("input,select").forEach(el=>el.value="");
        document.getElementById("studentStep1").classList.remove("hidden");
        document.getElementById("studentStep2").classList.add("hidden");
    })
    .catch(err=>{
        console.error(err);
        alert("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø§Ø·Ù„Ø§Ø¹Ø§Øª âŒ");
    });
}
</script>

</body>
</html>
